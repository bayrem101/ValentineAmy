<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Valentine ğŸ’˜</title>

<style>
  :root{
    --card: rgba(255,255,255,.14);
    --cardBorder: rgba(255,255,255,.22);
    --text: #ffffff;
    --yes: #22c55e;
    --no: #ef4444;
    --shadow: rgba(0,0,0,.35);
  }

  *{ box-sizing:border-box; }
  html, body { height:100%; }
  body{
    margin:0;
    min-height:100vh;
    display:grid;
    place-items:center;
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    color:var(--text);
    overflow:hidden;
    touch-action:none;
    background:
      radial-gradient(900px circle at 15% 20%, rgba(255,105,180,.45), transparent 55%),
      radial-gradient(900px circle at 85% 25%, rgba(99,102,241,.45), transparent 55%),
      radial-gradient(1100px circle at 50% 90%, rgba(34,197,94,.25), transparent 60%),
      linear-gradient(135deg, #0b1020, #120a2b);
  }

  .card{
    width:min(820px, 92vw);
    padding:28px 18px;
    border-radius:22px;
    background:var(--card);
    border:1px solid var(--cardBorder);
    backdrop-filter: blur(14px);
    box-shadow: 0 22px 70px var(--shadow);
    text-align:center;
    position:relative;
    z-index:1;
  }

  h1{
    margin: 2px 0 10px;
    font-size: clamp(22px, 5vw, 38px);
    letter-spacing: .2px;
  }

  .sub{
    margin: 0 0 14px;
    opacity:.92;
    font-weight:650;
  }

  .arena{
    position:relative;
    height: 320px;
    margin-top: 16px;
    border-radius: 18px;
    border: 1px dashed rgba(255,255,255,.22);
    background: rgba(0,0,0,.14);
    overflow:hidden;
    touch-action:none;
  }

  .btn{
    position:absolute;
    border:none;
    border-radius:999px;
    cursor:pointer;
    font-weight:900;
    letter-spacing:.6px;
    box-shadow:0 12px 28px rgba(0,0,0,.35);
    user-select:none;
    -webkit-tap-highlight-color:transparent;
    will-change: transform, left, top;
    touch-action: manipulation;
  }

  #yes{
    left:50%;
    top:74%;
    transform: translate(-50%, -50%) scale(1);
    background: var(--yes);
    color:#052e16;
    font-size: clamp(20px, 5vw, 26px);
    padding: 20px 60px;
    transition: transform .18s ease, filter .15s ease;
    z-index:2;
  }

  #yes.wiggle{
    animation: wiggle .18s ease;
  }
  @keyframes wiggle{
    0%{ transform: translate(-50%, -50%) scale(var(--s,1)) rotate(0deg); }
    50%{ transform: translate(-50%, -50%) scale(var(--s,1)) rotate(-2deg); }
    100%{ transform: translate(-50%, -50%) scale(var(--s,1)) rotate(2deg); }
  }

  #no{
    left:18%;
    top:26%;
    background: var(--no);
    color:white;
    font-size: 14px;
    padding: 11px 24px;
    transition: left .16s ease, top .16s ease, transform .16s ease;
    z-index:3;
  }
  #no.panic{
    animation: panic .22s linear;
    transform: rotate(6deg) scale(1.08);
  }
  @keyframes panic{
    0%{transform:translate(0,0) rotate(0deg)}
    25%{transform:translate(2px,-2px) rotate(4deg)}
    50%{transform:translate(-2px,2px) rotate(-4deg)}
    75%{transform:translate(2px,2px) rotate(4deg)}
    100%{transform:translate(0,0) rotate(0deg)}
  }

  .hint{
    margin-top: 12px;
    font-weight:850;
    opacity:.95;
    min-height: 74px;
    line-height: 1.25;
    transition: opacity .15s ease, transform .15s ease;
    text-wrap: balance;
  }
  .hint small{
    display:block;
    opacity:.9;
    font-weight:800;
    margin-top:6px;
  }

  .heart{
    position:fixed;
    left:0; top:0;
    pointer-events:none;
    opacity:.18;
    font-size: 18px;
    animation: floatUp linear forwards;
    z-index:0;
  }
  @keyframes floatUp{
    from{ transform: translate(var(--x), 110vh) rotate(0deg) scale(var(--s)); }
    to  { transform: translate(var(--x2), -10vh) rotate(360deg) scale(var(--s)); }
  }

  .overlay{
    position:fixed;
    inset:0;
    display:none;
    align-items:center;
    justify-content:center;
    padding:16px;
    background: rgba(0,0,0,.58);
    z-index:9999;
    touch-action:none;
  }
  .overlay.show{ display:flex; }

  .popup{
    width: min(560px, 92vw);
    border-radius: 22px;
    overflow:hidden;
    background: rgba(255,255,255,.12);
    border: 1px solid rgba(255,255,255,.22);
    backdrop-filter: blur(14px);
    box-shadow: 0 30px 90px rgba(0,0,0,.55);
    transform: translateY(18px) scale(.96);
    opacity:0;
    animation: popIn .38s ease forwards;
    text-align:center;
  }
  @keyframes popIn{
    to{ transform: translateY(0) scale(1); opacity:1; }
  }

  .gifwrap{ position:relative; }
  .gifwrap::after{
    content:"";
    position:absolute;
    inset:0;
    background: radial-gradient(500px circle at 50% 30%, rgba(255,255,255,.18), transparent 60%);
    pointer-events:none;
  }
  .popup img{ width:100%; height:auto; display:block; }

  .content{ padding: 14px 16px 18px; }
  .content h2{
    margin: 8px 0 6px;
    font-size: 30px;
    letter-spacing:.2px;
  }
  .type{
    margin-top:10px;
    font-weight:900;
    opacity:.96;
    min-height: 64px;
    white-space: pre-line;
  }

  .row{
    display:flex;
    gap:10px;
    justify-content:center;
    margin-top:14px;
    flex-wrap:wrap;
  }
  .closeBtn{
    border:none;
    border-radius:999px;
    padding: 10px 18px;
    font-weight:900;
    cursor:pointer;
    background: rgba(255,255,255,.18);
    color: white;
    border: 1px solid rgba(255,255,255,.25);
  }

  .particle{
    position:fixed;
    left:0; top:0;
    pointer-events:none;
    font-weight:900;
    transform: translate(-50%, -50%);
    animation: burst 950ms ease-out forwards;
    text-shadow: 0 14px 30px rgba(0,0,0,.35);
    z-index:10000;
  }
  @keyframes burst{
    0%   { transform: translate(var(--x0), var(--y0)) scale(.9) rotate(0deg); opacity:1; }
    75%  { opacity:1; }
    100% { transform: translate(var(--x1), var(--y1)) scale(1.2) rotate(var(--rot)); opacity:0; }
  }

  .toast{
    position:fixed;
    left:50%;
    bottom:26px;
    transform: translateX(-50%) translateY(12px) scale(.98);
    opacity:0;
    z-index:10001;
    background: rgba(255,255,255,.14);
    border: 1px solid rgba(255,255,255,.22);
    backdrop-filter: blur(12px);
    box-shadow: 0 20px 60px rgba(0,0,0,.45);
    color: white;
    padding: 10px 14px;
    border-radius: 999px;
    font-weight: 900;
    pointer-events:none;
    max-width: min(720px, 92vw);
    display:flex;
    align-items:center;
    gap:10px;
  }
  .toast img{
    width:34px;
    height:34px;
    border-radius:10px;
    object-fit:cover;
    border:1px solid rgba(255,255,255,.25);
    box-shadow: 0 10px 20px rgba(0,0,0,.35);
    flex:0 0 auto;
  }
  .toast .ttext{
    display:flex;
    flex-direction:column;
    line-height:1.05;
    gap:2px;
  }
  .toast .ttext .big{ font-size:14px; }
  .toast .ttext .small{ font-size:12px; opacity:.9; font-weight:800; }

  .toast.show{ animation: toastInOut 2.6s ease forwards; }
  @keyframes toastInOut{
    0%{ opacity:0; transform: translateX(-50%) translateY(14px) scale(.98); }
    16%{ opacity:1; transform: translateX(-50%) translateY(0) scale(1); }
    82%{ opacity:1; transform: translateX(-50%) translateY(0) scale(1); }
    100%{ opacity:0; transform: translateX(-50%) translateY(14px) scale(.98); }
  }

  /* âœ… START overlay: blur but NEVER block clicks */
  .startOverlay{
    position:fixed;
    inset:0;
    display:flex;
    align-items:center;
    justify-content:center;
    z-index:20000;
    background: rgba(0,0,0,.20);
  }
  .startOverlay::before{
    content:"";
    position:absolute;
    inset:0;
    backdrop-filter: blur(26px) saturate(140%);
    pointer-events:none; /* âœ… IMPORTANT */
  }
  .startOverlay::after{
    content:"";
    position:absolute;
    inset:0;
    background: radial-gradient(900px circle at 50% 40%, rgba(255,255,255,.07), transparent 60%),
                radial-gradient(900px circle at 50% 80%, rgba(0,0,0,.20), transparent 60%);
    pointer-events:none; /* âœ… IMPORTANT */
  }
  .startCard{
    position:relative;
    z-index:1;              /* âœ… above blur */
    width:min(460px, 92vw);
    border-radius:22px;
    background: rgba(255,255,255,.18);
    border:1px solid rgba(255,255,255,.22);
    box-shadow: 0 30px 90px rgba(0,0,0,.55);
    padding:18px 16px;
    text-align:center;
  }
  .startCard h3{ margin:0 0 6px; font-size:20px; }
  .startCard p{ margin:0 0 12px; opacity:.92; font-weight:700; }
  .startBtn{
    border:none;
    border-radius:999px;
    padding:12px 18px;
    font-weight:900;
    cursor:pointer;
    background: rgba(34,197,94,.92);
    color:#052e16;
    box-shadow:0 12px 28px rgba(0,0,0,.35);
  }
</style>
</head>

<body>

<div class="startOverlay" id="startOverlay" data-title="Amy ğŸ’˜" data-sub="Ready for a tiny surprise? ğŸ˜ˆ">
  <div class="startCard">
    <h3 id="startTitle"></h3>
    <p id="startSub"></p>
    <button class="startBtn" id="startBtn">Yalla ğŸš€</button>
  </div>
</div>

<div class="card">
  <h1>Amy, will you be my Valentine? ğŸ’˜</h1>
  <div class="sub">Try â€œNOâ€â€¦ if you can ğŸ˜„</div>

  <div class="arena" id="arena">
    <button class="btn" id="yes">YES ğŸ’š</button>
    <button class="btn" id="no">NO ğŸ˜…</button>
  </div>

  <div class="hint" id="hint">
    Ooops ğŸ˜„ it moved!
    <small>NO said: not today ğŸ˜…ğŸƒâ€â™‚ï¸ğŸ’¨</small>
  </div>
</div>

<div class="overlay" id="overlay">
  <div class="popup" role="dialog" aria-modal="true">
    <div class="gifwrap">
      <img alt="Celebration GIF"
        src="https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExbGlyeGp6NWFranVobTFnNTU3ZjJ5YXo3cDg2b3N3dXgzNDdrNmc5NCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/wexgpY05imDltSRKKo/giphy.gif" />
    </div>
    <div class="content">
      <h2>YAY ğŸ‰ğŸ’˜</h2>
      <div class="type" id="typeLine"></div>
      <div class="row">
        <button class="closeBtn" id="closeBtn">Close âœ¨</button>
      </div>
    </div>
  </div>
</div>

<div class="toast" id="toast">
  <img id="thaiImg" alt="Thailand" />
  <div class="ttext">
    <div class="big">See you in Thailand ğŸ‡¹ğŸ‡­</div>
    <div class="small">Thatâ€™s What She Said ğŸ˜‚</div>
  </div>
</div>

<script>
  const arena   = document.getElementById("arena");
  const noBtn   = document.getElementById("no");
  const yesBtn  = document.getElementById("yes");
  const hint    = document.getElementById("hint");

  const overlay = document.getElementById("overlay");
  const closeBtn= document.getElementById("closeBtn");
  const toast   = document.getElementById("toast");
  const typeLine= document.getElementById("typeLine");
  const thaiImg = document.getElementById("thaiImg");

  const startOverlay = document.getElementById("startOverlay");
  const startBtn = document.getElementById("startBtn");
  document.getElementById("startTitle").textContent = startOverlay.dataset.title || "Amy ğŸ’˜";
  document.getElementById("startSub").textContent   = startOverlay.dataset.sub   || "Ready? ğŸ˜ˆ";

  thaiImg.src = "./thai.jpg";
  thaiImg.onerror = () => { thaiImg.style.display = "none"; };

  function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }

  // Floating hearts
  function spawnFloatingHeart(){
    const el = document.createElement("div");
    el.className = "heart";
    el.textContent = Math.random() > 0.5 ? "ğŸ’—" : "ğŸ’˜";
    const x = Math.random()*100;
    const x2 = clamp(x + (Math.random()*30 - 15), 0, 100);
    const s = 0.8 + Math.random()*1.4;
    const dur = 7 + Math.random()*6;
    el.style.setProperty("--x", `${x}vw`);
    el.style.setProperty("--x2", `${x2}vw`);
    el.style.setProperty("--s", s.toFixed(2));
    el.style.animationDuration = `${dur.toFixed(1)}s`;
    document.body.appendChild(el);
    setTimeout(()=>el.remove(), dur*1000);
  }
  setInterval(spawnFloatingHeart, 560);

  // Typewriter
  function typeText(el, text, speed=26){
    el.textContent = "";
    let i = 0;
    const timer = setInterval(()=>{
      el.textContent += text[i] || "";
      i++;
      if(i > text.length) clearInterval(timer);
    }, speed);
  }

  // Confetti burst
  function spawnBurst(x,y){
    const emojis = ["ğŸ‰","ğŸ’˜","ğŸ’–","âœ¨","ğŸŠ","ğŸ’","ğŸ˜"];
    const count = 40;
    for(let i=0;i<count;i++){
      const el = document.createElement("div");
      el.className = "particle";
      el.textContent = emojis[Math.floor(Math.random()*emojis.length)];
      const x0 = x + (Math.random()*12 - 6);
      const y0 = y + (Math.random()*12 - 6);
      const angle = Math.random() * Math.PI * 2;
      const dist  = 140 + Math.random()*260;
      const x1 = x0 + Math.cos(angle)*dist;
      const y1 = y0 + Math.sin(angle)*dist + 120;
      el.style.setProperty("--x0", `${x0}px`);
      el.style.setProperty("--y0", `${y0}px`);
      el.style.setProperty("--x1", `${x1}px`);
      el.style.setProperty("--y1", `${y1}px`);
      el.style.setProperty("--rot", `${(Math.random()*720 - 360).toFixed(0)}deg`);
      el.style.fontSize = `${(14 + Math.random()*16).toFixed(0)}px`;
      document.body.appendChild(el);
      setTimeout(()=>el.remove(), 980);
    }
  }

  function showToast(){
    toast.classList.remove("show");
    void toast.offsetWidth;
    toast.classList.add("show");
  }

  // YES grows + wiggle
  let yesScale = 1;
  let dodgeCount = 0;

  function growYes(){
    yesScale = Math.min(1.95, yesScale + 0.06);
    yesBtn.style.setProperty("--s", yesScale.toFixed(2));
    yesBtn.style.transform = `translate(-50%, -50%) scale(${yesScale.toFixed(2)})`;
    yesBtn.classList.remove("wiggle");
    void yesBtn.offsetWidth;
    yesBtn.classList.add("wiggle");
  }

  function panicNo(){
    noBtn.classList.add("panic");
    setTimeout(() => noBtn.classList.remove("panic"), 230);
  }

  // AUDIO
  let audioCtx = null;
  let master = null;

  function initAudio(){
    if (audioCtx) return;
    const AudioCtx = window.AudioContext || window.webkitAudioContext;
    audioCtx = new AudioCtx();
    master = audioCtx.createGain();
    master.gain.value = 0.26;
    master.connect(audioCtx.destination);
  }

  function beep(freq, start, dur, type="square", peak=0.35){
    if (!audioCtx || !master) return;
    const o = audioCtx.createOscillator();
    const g = audioCtx.createGain();
    o.type = type;
    o.frequency.setValueAtTime(freq * 0.985, start);
    o.frequency.exponentialRampToValueAtTime(freq, start + 0.01);
    g.gain.setValueAtTime(0.0001, start);
    g.gain.exponentialRampToValueAtTime(peak, start + 0.01);
    g.gain.exponentialRampToValueAtTime(0.0001, start + dur);
    o.connect(g).connect(master);
    o.start(start);
    o.stop(start + dur + 0.03);
  }

  function playPump(){
    if (!audioCtx || audioCtx.state !== "running") return;
    const t = audioCtx.currentTime;
    beep(740, t, 0.06, "square", 0.22);
    beep(980, t + 0.06, 0.07, "square", 0.20);
  }

  function playVictory(){
    if (!audioCtx || audioCtx.state !== "running") return;
    const t0 = audioCtx.currentTime;
    const melody = [
      [659, 0.00, 0.09],
      [784, 0.10, 0.09],
      [988, 0.20, 0.10],
      [1319,0.32, 0.12],
      [1175,0.46, 0.10],
      [1319,0.58, 0.14],
      [1568,0.74, 0.22],
    ];
    melody.forEach(([f, off, dur]) => beep(f, t0 + off, dur, "square", 0.32));
    beep(988,  t0 + 0.78, 0.18, "triangle", 0.16);
    beep(1319, t0 + 0.78, 0.18, "triangle", 0.16);
    beep(1568, t0 + 0.78, 0.18, "triangle", 0.16);
  }

  // âœ… START: unlock audio + hide overlay (FIRST interaction)
  startBtn.addEventListener("pointerdown", async (e) => {
    initAudio();
    if (audioCtx.state === "suspended") { try { await audioCtx.resume(); } catch {} }
    if (audioCtx && audioCtx.state === "running") beep(220, audioCtx.currentTime, 0.03, "sine", 0.06);
    startOverlay.style.display = "none";
    e.preventDefault();
  }, { passive:false });

  // EXACT chase texts ONLY
  const chaseTexts = [
    ["Ooops ğŸ˜„ it moved!", "NO said: not today ğŸ˜…ğŸƒâ€â™‚ï¸ğŸ’¨"],
    ["NO is in olympic mode ğŸƒâ€â™‚ï¸ğŸ’¨", "Gold medal in running away ğŸ¥‡"],
    ["At this pointâ€¦ just click YES ğŸ˜‡", "Because NO is toxic ğŸ˜­"],
    ["Mission impossible ğŸ¬", "You vs. a button with attitude ğŸ˜¤"],
  ];

  let lastHintChange = 0;
  const HINT_COOLDOWN_MS = 1500;
  function setHint2Lines(line1, line2){
    const now = Date.now();
    if (now - lastHintChange < HINT_COOLDOWN_MS) return;
    hint.style.opacity = 0.35;
    hint.style.transform = "translateY(2px)";
    setTimeout(()=>{
      hint.innerHTML = `${line1}<small>${line2}</small>`;
      hint.style.opacity = 1;
      hint.style.transform = "translateY(0)";
    }, 130);
    lastHintChange = now;
  }

  function moveNoButtonAway(clientX, clientY){
    const a = arena.getBoundingClientRect();
    const b = noBtn.getBoundingClientRect();
    const px = clientX - a.left;
    const py = clientY - a.top;

    const noCx = (b.left - a.left) + b.width/2;
    const noCy = (b.top  - a.top ) + b.height/2;

    let dx = noCx - px;
    let dy = noCy - py;
    if (Math.abs(dx) < 0.01 && Math.abs(dy) < 0.01){
      dx = Math.random() - 0.5;
      dy = Math.random() - 0.5;
    }
    const len = Math.hypot(dx,dy) || 1;
    dx /= len; dy /= len;

    const jump = 170 + Math.random()*170;
    const currentLeft = noBtn.offsetLeft;
    const currentTop  = noBtn.offsetTop;

    let newLeft = currentLeft + dx*jump;
    let newTop  = currentTop  + dy*jump;

    const maxLeft = arena.clientWidth - noBtn.offsetWidth;
    const maxTop  = arena.clientHeight - noBtn.offsetHeight;

    newLeft = clamp(newLeft, 0, maxLeft);
    newTop  = clamp(newTop,  0, maxTop);

    if (Math.abs(newLeft - currentLeft) < 40 && Math.abs(newTop - currentTop) < 40){
      newLeft = Math.random()*maxLeft;
      newTop  = Math.random()*maxTop;
    }

    noBtn.style.left = `${newLeft}px`;
    noBtn.style.top  = `${newTop}px`;

    panicNo();
    dodgeCount++;

    const idx = Math.min(chaseTexts.length - 1, Math.floor(dodgeCount / 2));
    const [l1,l2] = chaseTexts[idx];
    setHint2Lines(l1,l2);

    growYes();
    playPump();
  }

  // NO dodge only when close
  arena.addEventListener("pointermove", (e) => {
    const b = noBtn.getBoundingClientRect();
    const dist = Math.hypot(
      e.clientX - (b.left + b.width/2),
      e.clientY - (b.top + b.height/2)
    );
    if (dist < 150) moveNoButtonAway(e.clientX, e.clientY);
  }, { passive:true });

  noBtn.addEventListener("pointerdown", (e) => {
    moveNoButtonAway(e.clientX, e.clientY);
    e.preventDefault();
  }, { passive:false });

  // YES click
  yesBtn.addEventListener("pointerdown", (e) => {
    playVictory();
    overlay.classList.add("show");
    spawnBurst(e.clientX, e.clientY);

    typeText(
      typeLine,
      "YAY ğŸ‰ğŸ’˜\nthat's What She Said ğŸ˜‚\nSucksâ€¦ yaa you didnâ€™t have any choice ğŸ©·",
      26
    );

    e.preventDefault();
  }, { passive:false });

  function closeOverlay(){
    overlay.classList.remove("show");
    showToast();
  }
  closeBtn.addEventListener("pointerdown", (e) => { closeOverlay(); e.preventDefault(); }, { passive:false });
  overlay.addEventListener("pointerdown", (e) => { if (e.target === overlay) closeOverlay(); }, { passive:true });
</script>
</body>
</html>
